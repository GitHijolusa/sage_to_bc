{
    "urlEmpleados": "http://sql-nav-pre:7048/BC_Test/ODataV4/Company('AGRICOLA%20VILLENA%20SL')/Empleados",
    "usernameBC": "SQL-NAV-PRE\\ALFREDO.BLANCO",
    "passwordBC": "Rol62357",
    "userDb": "alfredo.blanco",
    "passwordDb": "Rol62357",
    "ipDb": "192.168.1.221",
    "db": "LOGIC",
    "query": "\nSELECT DISTINCT \n    p.[SiglaNacion],\n    p.[Dni],\n    n.CodigoEmpleado,\n    [NombreEmpleado],\n    [ProvNumSoe],\n    [PrimerApellidoEmpleado],\n    [SegundoApellidoEmpleado],\n    pd.[CodigoPostal],\n    pd.DireccionCompleta,\n    pd.[Telefono],\n    pd.[TelefonoMovil],\n    pd.[Municipio],\n    pd.[Provincia],\n    [Sexo],\n    [FechaNacimiento],\n    p.[EMail1],\n    [FechaInicioContrato],\n    [FechaFinalContrato],\n    co.[IBANReceptor]\nFROM \n    [LOGIC].[dbo].[Personas] AS p\nJOIN (\n    SELECT \n        Dni, \n        CodigoEmpleado, \n        FechaInicioContrato,\n        FechaFinalContrato,\n        ROW_NUMBER() OVER (PARTITION BY CodigoEmpleado ORDER BY FechaInicioContrato DESC) AS rn \n    FROM \n        dbo.EmpleadoNomina\n) AS n ON p.Dni = n.Dni AND n.rn = 1\nLEFT JOIN (\n    SELECT \n        CodigoEmpleado, \n        IBANReceptor,\n        ROW_NUMBER() OVER (PARTITION BY CodigoEmpleado ORDER BY FechaAlta DESC) AS rn \n    FROM \n        dbo.EmpleadoCobro\n) AS co ON n.CodigoEmpleado = co.CodigoEmpleado AND co.rn = 1\nLEFT JOIN (\n    SELECT \n        [Dni]\n        ,[ViaPublica]\n        ,[Numero1]\n        ,[Numero2]\n        ,[Escalera]\n        ,[Piso]\n        ,[Puerta]\n        ,[Letra]\n        ,[CodigoPostal]\n        ,[Telefono]\n        ,[TelefonoMovil]\n        ,[Municipio]\n        ,[Provincia]\n        ,[IdDomicilio]\n        ,CASE \n            WHEN [ViaPublica] IS NOT NULL THEN [ViaPublica] + ' ' ELSE '' END +\n            CASE \n            WHEN [Numero1] IS NOT NULL THEN [Numero1] + ' ' ELSE '' END +\n            CASE \n            WHEN [Numero2] IS NOT NULL THEN [Numero2] + ' ' ELSE '' END +\n            CASE \n            WHEN [Escalera] IS NOT NULL THEN [Escalera] + ' ' ELSE '' END +\n            CASE \n            WHEN [Piso] IS NOT NULL THEN [Piso] + ' ' ELSE '' END +\n            CASE \n            WHEN [Puerta] IS NOT NULL THEN [Puerta] + ' ' ELSE '' END +\n            CASE \n            WHEN [Letra] IS NOT NULL THEN [Letra] + ' ' ELSE '' END AS DireccionCompleta,\n        ROW_NUMBER() OVER (PARTITION BY [Dni] ORDER BY [IdDomicilio] DESC) AS RowNum\n    FROM [LOGIC].[dbo].[PersonasDomicilios]\n) AS pd ON p.Dni = pd.Dni AND pd.RowNum = 1\nORDER BY \n    n.CodigoEmpleado\n"
}